/*! LocalModel | Developer: Rick Craig | https://github.com/RickCraig/localmodel */
"use strict";var generateUUID=function(){var e=Date.now(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)});return t},getKey=function(e,t){return e+"::"+t},addIndex=function(e,t){var n=e+"-index",i=localStorage.getItem(n),o=i?JSON.parse(i):[];o.push(t),localStorage.setItem(n,JSON.stringify(o))},getIndices=function(e){var t=localStorage.getItem(e+"-index");return t?JSON.parse(t):[]},getIndex=function(e,t){for(var n=new RegExp("::"+t,"g"),i=0;i<e.length;i++){var o=e[i];if(n.test(o))return o}},LocalSchema=function(e,t){this.schema=t,this.name=e};LocalSchema.prototype.create=function(e){var t={};t._id=generateUUID();for(var n in this.schema)t[n]=e[n];var i=getKey(this.name,t._id);return localStorage.setItem(i,JSON.stringify(t)),addIndex(this.name,i),t},LocalSchema.prototype.all=function(){this.indices=this.indices||getIndices(this.name);for(var e=[],t=0;t<this.indices.length;t++){var n=this.indices[t],i=JSON.parse(localStorage.getItem(n));e.push(i)}return e},LocalSchema.prototype.findById=function(e){this.indices=this.indices||getIndices(this.name);var t=getIndex(this.indices,e);if(t)return JSON.parse(localStorage.getItem(t))},LocalSchema.prototype.find=function(e){this.indices=this.indices||getIndices(this.name);for(var t=[],n=0;n<this.indices.length;n++){var i=localStorage.getItem(this.indices[n]);i=JSON.parse(i);var o=!1;for(var r in i){var a=e[r];a&&(o=a instanceof RegExp?a.test(i[r]):i[r]===a)}o&&t.push(i)}return t},LocalSchema.SchemaTypes={String:"string",Number:"number",Boolean:"boolean",Mixed:"mixed"};var LocalModels=function(e){this.options=e||{},this.models={}};LocalModels.prototype.addModel=function(e,t){var n=new LocalSchema(e,t);return this.models[e]=n,n},LocalModels.prototype.model=function(e){return this.models[e]?this.models[e]:void console.error('The model with name "%s" does not exist.',e)};